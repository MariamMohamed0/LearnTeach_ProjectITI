<!-- <div *ngIf="chatId; else noChat" class="flex flex-col h-full bg-gray-50">

  <div class="bg-slate-800 text-white border-b border-slate-700 flex items-center gap-3 p-4 shadow-sm">
    <div class="avatar">
      <div class="w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center">
        <span class="text-white font-medium">U</span>
      </div>
    </div>
    <div>
      <div class="text-lg font-semibold">Chat: {{ chatId }}</div>
      <p class="text-sm text-slate-300">You: {{ currentUserId }}</p>
    </div>
  </div>


  <div class="flex-1 overflow-y-auto p-4 space-y-6 bg-gradient-to-b from-slate-50 to-slate-100">


    <div *ngIf="isLoading" class="flex justify-center">
      <div class="bg-white rounded-xl shadow-sm p-4 max-w-xs text-center">
        <div class="flex justify-center space-x-1">
          <div class="w-2 h-2 bg-slate-400 rounded-full animate-bounce"></div>
          <div class="w-2 h-2 bg-slate-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
          <div class="w-2 h-2 bg-slate-400 rounded-full animate-bounce" style="animation-delay: 0.4s"></div>
        </div>
        <p class="text-sm text-slate-500 mt-2">Loading...</p>
      </div>
    </div>


    <div *ngIf="!isLoading && messages.length === 0" class="flex flex-col items-center justify-center h-full text-center">
      <div class="bg-white rounded-2xl shadow-sm p-8 max-w-md">
        <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-slate-100 flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
          </svg>
        </div>
        <h3 class="text-lg font-medium text-slate-800 mb-2">No Messages Yet</h3>
        <p class="text-sm text-slate-500">Start Conversation</p>
      </div>
    </div>


    <div *ngFor="let m of messages">

  
      <div *ngIf="m.senderId === currentUserId" class="flex gap-3 flex-row-reverse mb-4 text-right">

        <div class="avatar h-10 w-10 shrink-0">
          <div class="rounded-full bg-gradient-to-r from-slate-700 to-slate-800 flex items-center justify-center text-white font-medium shadow-sm">
            Me
          </div>
        </div>

        <div class="flex flex-col items-end max-w-[75%]">
          <div class="rounded-2xl rounded-tr-md px-4 py-3 bg-gradient-to-r from-slate-700 to-slate-800 text-white shadow-sm">
            <p class="text-sm break-words whitespace-pre-wrap">{{ m.text }}</p>
          </div>

          <p class="text-xs text-slate-500 mt-1 flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            {{ m.timestamp | date: 'shortTime' }}
          </p>
        </div>
      </div>

  
      <div *ngIf="m.senderId !== currentUserId" class="flex gap-3 mb-4 text-left">

        <div class="avatar h-10 w-10 shrink-0">
          <div class="rounded-full bg-gradient-to-r from-slate-600 to-slate-700 flex items-center justify-center text-white font-medium shadow-sm">
            U
          </div>
        </div>

        <div class="flex flex-col items-start max-w-[75%]">
          <div class="rounded-2xl rounded-tl-md px-4 py-3 bg-white shadow-sm border border-slate-200">
            <p class="text-sm break-words whitespace-pre-wrap text-slate-800">{{ m.text }}</p>
          </div>

          <p class="text-xs text-slate-500 mt-1 flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            {{ m.timestamp | date: 'shortTime' }}
          </p>
        </div>
      </div>

    </div>
  </div>


  <div class="border-t border-slate-200 bg-white p-4 shadow-sm">
    <form class="flex gap-2" (submit)="sendMessage(); $event.preventDefault()">

      <div class="flex-1 relative">
        <input
          class="w-full border border-slate-300 rounded-2xl p-3 pr-10 focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-transparent transition-all"
          [(ngModel)]="newMessageText"
          (keydown.enter)="sendMessage()"
          name="msgInput"
          placeholder="Type a message..."
        />
      </div>

      <button 
        class="bg-gradient-to-r from-slate-700 to-slate-800 hover:from-slate-800 hover:to-slate-900 text-white rounded-2xl px-6 transition-all shadow-sm flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed" 
        [disabled]="isSending || !newMessageText.trim()" 
        type="submit"
      >
        <span *ngIf="!isSending">Send</span>
        <span *ngIf="isSending" class="flex items-center">
          <svg class="animate-spin h-4 w-4 mr-1 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          Sending
        </span>
      </button>

    </form>
  </div>

</div>


<ng-template #noChat>
  <div class="h-full flex items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100">
    <div class="text-center p-8 max-w-md">
      <h3 class="text-xl font-semibold text-slate-800 mb-2">اختر محادثة للبدء</h3>
      <p class="text-slate-500">اختر محادثة من القائمة لبدء التحدث</p>
    </div>
  </div>
</ng-template>







 -->

 <!-- <div class="chat-window">


  <div class="chat-header">
    <div class="user-info">
      <img src="assets/people.png" class="avatar" />
      <div class="user-text">
        <h3>Mohamed</h3>
        <span class="username">@Mohamed</span>
      </div>
    </div>

    <div class="header-actions">
    
      <i class="icon bi-telephone"></i>
      <i class="icon bi-camera-video"></i>
      <i class="icon bi-three-dots-vertical"></i>
    </div>
  </div>

 
  <div class="messages-list">

    <div *ngIf="isLoading" class="loading">Loading...</div>

    <div *ngFor="let msg of messages" class="message-wrapper"
      [ngClass]="{ 'me': msg.senderId === currentUserId }">

      <img src="assets/people.png" class="msg-avatar" *ngIf="msg.senderId !== currentUserId">

      <div class="bubble" [ngClass]="msg.senderId === currentUserId ? 'mine' : 'theirs'">
        {{ msg.text }}
      </div>
      
    </div>
    

  </div>


  <div class="chat-input">
    <input [(ngModel)]="newMessageText" placeholder="Write your message..." />
    <button (click)="sendMessage()" [disabled]="isSending">
      <i class="bi bi-send-fill"></i>
    </button>
  </div>

</div> -->

<div class="chat-window">

  <!-- Header -->
  <div class="chat-header">
    <div class="user-info">
      <i class="nada fa-solid fa-user fa-xs" style="color: #458af8; "></i>
      <div class="user-text">
        <h3>Mohamed</h3>
        <span class="username">@Mohamed</span>
      </div>
    </div>

    <div class="header-actions">
      <i class="icon bi-telephone"></i>
      <i class="icon bi-camera-video"></i>
      <i class="icon bi-three-dots-vertical"></i>
    </div>
  </div>

  <!-- Messages Area -->
  <div class="messages-list">

    <div *ngIf="isLoading" class="loading">Loading...</div>

    <div *ngFor="let msg of messages"
         class="message-wrapper"
         [ngClass]="{ 'me': msg.senderId === currentUserId }">

      <!-- Avatar -->
      <img src="assets/people.png"
           class="msg-avatar"
           *ngIf="msg.senderId !== currentUserId">

      <!-- Bubble + Time -->
      <div class="bubble-container">

        <div class="bubble"
             [ngClass]="msg.senderId === currentUserId ? 'mine' : 'theirs'">
          {{ msg.text }}
        </div>

        <div class="timestamp">
          {{ msg.timestamp | date:'shortTime' }}
        </div>

      </div>
    </div>

  </div>

  <!-- Input -->
  <div class="chat-input">
    <input [(ngModel)]="newMessageText"
           placeholder="Write your message..." />

    <button (click)="sendMessage()" [disabled]="isSending">
      <i class="bi bi-send-fill"></i>
    </button>
  </div>

</div>


