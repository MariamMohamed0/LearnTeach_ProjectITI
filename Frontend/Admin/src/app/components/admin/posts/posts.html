<section class="flex w-full min-h-screen bg-gray-50 dark:bg-gray-900 ">
  <div [ngClass]="{
        'fixed inset-0 z-50 transform transition-transform duration-300': isMobile(),
        '-translate-x-full': isMobile() && !isSidebarOpen,

        'w-7': !isSidebarOpen && !isMobile(),
        'w-60': isSidebarOpen || isMobile()
      }" class="bg-white dark:bg-gray-800 shadow-lg transition-all duration-300 flex-shrink-0">
    <app-sidebar [collapsed]="!isSidebarOpen"></app-sidebar>
  </div>

  <div *ngIf="isSidebarOpen && isMobile()" class="fixed inset-0 bg-black/40 z-40" (click)="toggleSidebar()"></div>

  <main [ngClass]="{
      'ml-0 w-full': isMobile(),
      'ml-9 w-[calc(100%-2rem)]': !isSidebarOpen && !isMobile(),   
      'ml-5 w-[calc(100%-14rem)]': isSidebarOpen && !isMobile()   
    }" class="flex flex-col transition-all duration-300  overflow-auto">

    <app-admin-header [isDarkMode]="isDarkMode" (toggleSidebarEvent)="toggleSidebar()"
      (toggleDarkModeEvent)="toggleDarkMode()">
    </app-admin-header>

<div class="pr-3 pl-3 mt-4">

  <!-- Page Content -->
  <div>

    <!-- Header -->
    <div class="flex flex-col sm:flex-row items-center justify-between mb-8 gap-4">
      <h2 class="text-3xl font-bold text-gray-800">{{tr('Manage Posts')}}</h2>

      <!-- <div class="flex gap-3 w-full sm:w-auto">
        <input
          type="text"
          [(ngModel)]="search"
         placeholder="{{ tr('Search posts...') }}"

          (keyup.enter)="onSearch()"
          class="w-full sm:w-64 px-4 py-2 rounded-xl border border-gray-300 shadow-sm focus:ring-2 focus:ring-indigo-500 transition"
        />

        <button
          (click)="onSearch()"
          class="bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2 rounded-xl shadow-md transition"
        >
          {{tr('Search')}}
        </button>
      </div> -->
    </div>

    <!-- Loading -->
    <div *ngIf="loading" class="text-center py-10 text-gray-500 text-lg animate-pulse">
     {{tr(' Loading posts...')}}
    </div>

    <!-- Error -->
    <div *ngIf="error" class="text-center text-red-600 font-semibold py-4 rounded-lg bg-red-50">
      {{ error }}
    </div>

    <!-- No Data -->
    <div *ngIf="!loading && posts.length === 0" class="text-center text-gray-500 py-12 text-xl">
      No posts found.
    </div>

    <!-- Table -->
    <div *ngIf="posts.length > 0" class="overflow-x-auto bg-white dark:bg-gray-800 shadow rounded-lg mt-4">
      <table class="w-full text-left min-w-[400px] ">
        <thead class="bg-gray-100 border-b dark:bg-gray-700">
          <tr>
            <th class="px-4 py-3 text-gray-900 dark:text-gray-100 " style="text-align: center;">{{tr('ID')}}</th>
            <th class="px-4 py-3 text-gray-900 dark:text-gray-100 " style="text-align: center;">{{tr('Content')}}</th>
            <th class="px-4 py-3 text-gray-900 dark:text-gray-100 " style="text-align: center;">{{tr('Skill')}}</th>
            <th class="px-4 py-3 text-gray-900 dark:text-gray-100 " style="text-align: center;">{{tr('Likes')}}</th>
            <th class="px-4 py-3 text-gray-900 dark:text-gray-100 " style="text-align: center;">{{tr('Comments')}}</th>
            <th class="px-4 py-3 text-gray-900 dark:text-gray-100 " style="text-align: center;">{{tr('Created')}} </th>
            <th class="px-4 py-3 text-gray-900 dark:text-gray-100 " style="text-align: center;">{{tr('Actions')}}</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let p of posts" class="table-row">
            <td class="px-4 py-3 font-medium text-gray-900 dark:text-gray-100"style="text-align: center;">{{ p.postId }}</td>
            <td class="px-4 py-3 font-medium text-gray-900 dark:text-gray-100"style="text-align: center;">{{ p.content }}</td>
            <td class="px-4 py-3 font-medium text-gray-900 dark:text-gray-100"style="text-align: center;">{{ p.skillName }}</td>
            <td class="px-4 py-3 font-medium text-gray-900 dark:text-gray-100"style="text-align: center;">{{ p.totalLiked ?? 0 }}</td>
            <td class="px-4 py-3 font-medium text-gray-900 dark:text-gray-100"style="text-align: center;">{{ p.totalComments ?? 0 }}</td>
            <td class="px-4 py-3 font-medium text-gray-900 dark:text-gray-100"style="text-align: center;">{{ p.createdAt | date:'medium' }}</td>

            <td class="table-data">
              <div class="flex gap-2 justify-center">

                <!-- <button
                  [routerLink]="['/admin/posts', p.postId]"
                  class="btn-blue"
                >
                  View
                </button> -->

                <button 
                    class="btn btn-primary p-2  dark:bg-blue-700  transition p-3"
                     [routerLink]="['/admin/posts', p.postId, 'comments']">
                    <i class="fa-solid fa-eye"></i>
                 </button>

                 <button class="p-2 bg-red-100 dark:bg-red-100 text-red-600   transition rounded-lg p-3" [routerLink]="['/admin/posts', p.postId, 'likes']">
                  <!-- <i class="fa-regular fa-heart"> -->
                    <i class="fa-solid fa-thumbs-up"></i>
                  </button>

                <button
                  (click)="onDelete(p.postId)"
                  class="btn-red"
                >
                  <i class="fa-solid fa-trash"></i>
                </button>

              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div class="flex flex-col sm:flex-row justify-between items-center mt-8 gap-4">
      <p class="text-gray-600 text-sm">
        {{tr('Showing')}} {{ posts.length }} of {{ total }}
      </p>

      <div class="flex items-center gap-3">
        <button
          class="pagination-btn"
          [disabled]="page <= 1"
          (click)="onPageChange(page - 1)"
        >
          {{tr('Previous')}}
        </button>

        <span class="font-semibold text-gray-700">{{tr('Page')}} {{ page }}</span>

        <button
          class="pagination-btn"
          [disabled]="posts.length < pageSize"
          (click)="onPageChange(page + 1)"
        >
          {{tr('Next')}}
        </button>
      </div>
    </div>

  </div>
</div>
  </main>
  </section>
